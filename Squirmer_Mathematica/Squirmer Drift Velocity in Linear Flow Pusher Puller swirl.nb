(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83827,       2028]
NotebookOptionsPosition[     77899,       1914]
NotebookOutlinePosition[     78242,       1929]
CellTagsIndexPosition[     78199,       1926]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "Matte"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"$Path", ",", 
      RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "Matte`"}]}]}]], "Input",
 CellChangeTimes->{{3.789847159087984*^9, 3.7898471599092283`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"8f807011-4ee0-4c8a-99a4-0c4c5dcb1e6d"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Matte package loaded. \[Copyright] 2017-2018 Jonas \
Einarsson (me@jonaseinarsson.se)\"\>"], "Print",
 CellChangeTimes->{
  3.788297573220861*^9, 3.7885390563760147`*^9, 3.788638767083486*^9, {
   3.78863887520662*^9, 3.788638900506867*^9}, 3.7886599140442057`*^9, 
   3.7898446625315857`*^9, 3.789845293123279*^9, 3.789847160302403*^9, 
   3.80573409597225*^9, 3.8057384197448673`*^9, 3.805807161806994*^9, 
   3.80582369794254*^9, 3.808050029873455*^9, 3.809286536314559*^9, {
   3.8092868269750414`*^9, 3.8092868549563212`*^9}, 3.8092868864113517`*^9, 
   3.8092869419277773`*^9, 3.809288144932336*^9, 3.8092882435969667`*^9, 
   3.809290832732686*^9, 3.809294791687565*^9, 3.809367872465106*^9, 
   3.8095595250652604`*^9, 3.8096205719349976`*^9, 3.809620687681757*^9, 
   3.8096208460510473`*^9, 3.8096209081248636`*^9, 3.8096209397949333`*^9, 
   3.809620988256753*^9, 3.809621555541854*^9, 3.809621751706333*^9, 
   3.809622643384137*^9, 3.8096290850099*^9, 3.8096292130958986`*^9, 
   3.809630130242838*^9, 3.809719635777439*^9, {3.8098121338152637`*^9, 
   3.809812135375304*^9}, 3.8099605936541357`*^9, 3.8099863245934477`*^9, 
   3.8099863664825497`*^9, {3.811868314347311*^9, 3.8118683157152157`*^9}, 
   3.811868609120682*^9, 3.8118686706421137`*^9, 3.811868870199251*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"112f3404-b985-42f8-9774-32f5a41e0479"],

Cell[BoxData["\<\"Released under the MIT License \
https://opensource.org/licenses/MIT\"\>"], "Print",
 CellChangeTimes->{
  3.788297573220861*^9, 3.7885390563760147`*^9, 3.788638767083486*^9, {
   3.78863887520662*^9, 3.788638900506867*^9}, 3.7886599140442057`*^9, 
   3.7898446625315857`*^9, 3.789845293123279*^9, 3.789847160302403*^9, 
   3.80573409597225*^9, 3.8057384197448673`*^9, 3.805807161806994*^9, 
   3.80582369794254*^9, 3.808050029873455*^9, 3.809286536314559*^9, {
   3.8092868269750414`*^9, 3.8092868549563212`*^9}, 3.8092868864113517`*^9, 
   3.8092869419277773`*^9, 3.809288144932336*^9, 3.8092882435969667`*^9, 
   3.809290832732686*^9, 3.809294791687565*^9, 3.809367872465106*^9, 
   3.8095595250652604`*^9, 3.8096205719349976`*^9, 3.809620687681757*^9, 
   3.8096208460510473`*^9, 3.8096209081248636`*^9, 3.8096209397949333`*^9, 
   3.809620988256753*^9, 3.809621555541854*^9, 3.809621751706333*^9, 
   3.809622643384137*^9, 3.8096290850099*^9, 3.8096292130958986`*^9, 
   3.809630130242838*^9, 3.809719635777439*^9, {3.8098121338152637`*^9, 
   3.809812135375304*^9}, 3.8099605936541357`*^9, 3.8099863245934477`*^9, 
   3.8099863664825497`*^9, {3.811868314347311*^9, 3.8118683157152157`*^9}, 
   3.811868609120682*^9, 3.8118686706421137`*^9, 3.811868870200946*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"c91dc84f-52d8-4066-8cd9-ce1bee7acee1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Define basic multipoles\
\>", "Subsection",
 CellChangeTimes->{{3.8096208318628826`*^9, 3.809620834487461*^9}, {
  3.8099863278531933`*^9, 3.809986328798294*^9}, {3.811868253659449*^9, 
  3.811868259667458*^9}},ExpressionUUID->"1932942e-5af2-41a9-b806-\
be40a27cc43a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"getStokeslet", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"delta", "[", 
     RowBox[{"i", ",", "j"}], "]"}], 
    RowBox[{"invr", "[", "1", "]"}]}], "+", 
   RowBox[{
    RowBox[{"r", "[", "i", "]"}], 
    RowBox[{"r", "[", "j", "]"}], 
    RowBox[{"invr", "[", "3", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getStokesletP", "[", "j_", "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"r", "[", "j", "]"}], 
   RowBox[{"invr", "[", "3", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"laplacer", "[", 
     RowBox[{"getStokeslet", "[", 
      RowBox[{
       RowBox[{"idx", "[", "1", "]"}], ",", 
       RowBox[{"idx", "[", "2", "]"}]}], "]"}], "]"}], "-", 
    RowBox[{"partialr", "[", 
     RowBox[{
      RowBox[{"getStokesletP", "[", 
       RowBox[{"idx", "[", "2", "]"}], "]"}], ",", 
      RowBox[{"idx", "[", "1", "]"}]}], "]"}]}], "//", "contract"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"check", " ", "Stokes", " ", 
    RowBox[{"eq", ".", " ", "satisfied"}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getDipole", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"partialr", "[", 
    RowBox[{
     RowBox[{"getStokeslet", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", "k"}], "]"}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getRotlet", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"getDipole", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"getDipole", "[", 
      RowBox[{"i", ",", "k", ",", "j"}], "]"}]}]}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getStresslet", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"getDipole", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"getDipole", "[", 
      RowBox[{"i", ",", "k", ",", "j"}], "]"}]}]}], "//", 
   "contract"}]}]}], "Input",
 CellChangeTimes->{{3.788297605541177*^9, 3.788297605943077*^9}, 
   3.7882981202250767`*^9, {3.788298780810481*^9, 3.788298825876356*^9}, {
   3.788298902342609*^9, 3.788298905495823*^9}, {3.788299118438889*^9, 
   3.788299270412331*^9}, {3.7882993048261757`*^9, 3.788299356480729*^9}, {
   3.788299434249909*^9, 3.788299519767446*^9}, {3.788299619123736*^9, 
   3.788299666658428*^9}, {3.7882997160837593`*^9, 3.788299786535396*^9}, {
   3.788299875758644*^9, 3.78829988269207*^9}, {3.7883010392242928`*^9, 
   3.78830115192747*^9}, {3.788301261725779*^9, 3.788301262535264*^9}, {
   3.788301515193481*^9, 3.788301518418964*^9}, {3.7883015706267223`*^9, 
   3.788301571996375*^9}, {3.788301645410228*^9, 3.78830167987052*^9}, {
   3.788461449252481*^9, 3.788461494054152*^9}, {3.788461844320252*^9, 
   3.7884619723080378`*^9}, {3.788462015546669*^9, 3.78846201855796*^9}, {
   3.788469647845367*^9, 3.788469671100687*^9}, {3.7884697692717113`*^9, 
   3.788469793371731*^9}, {3.7884699067165956`*^9, 3.788469998634449*^9}, {
   3.788470738794339*^9, 3.78847074026396*^9}, {3.788471405779128*^9, 
   3.788471408916936*^9}, {3.788537467927544*^9, 3.7885374704785557`*^9}, {
   3.7885380200119247`*^9, 3.788538021444927*^9}, {3.788538478281528*^9, 
   3.788538480619629*^9}, 3.788538758464275*^9, {3.788538836815811*^9, 
   3.7885388376254997`*^9}, {3.788538888815198*^9, 3.788539049390832*^9}, {
   3.788539096810433*^9, 3.7885391871238413`*^9}, {3.7885392212527103`*^9, 
   3.78853923093421*^9}, {3.7885415448967743`*^9, 3.788541555570465*^9}, {
   3.788541586750842*^9, 3.7885415879099817`*^9}, {3.7885443948960667`*^9, 
   3.788544397943222*^9}, {3.7885449006412563`*^9, 3.788544967907227*^9}, {
   3.7885452389359713`*^9, 3.788545289724612*^9}, {3.788545324785203*^9, 
   3.788545567464774*^9}, {3.788545704924983*^9, 3.7885457096823483`*^9}, {
   3.788546269674527*^9, 3.788546287817636*^9}, {3.788546318824359*^9, 
   3.788546366646886*^9}, 3.7885465202520237`*^9, {3.788547788604051*^9, 
   3.788547800994761*^9}, {3.805738451821937*^9, 3.805738453517189*^9}, {
   3.805739795085586*^9, 3.805739817693576*^9}, {3.805740007917774*^9, 
   3.805740009812956*^9}, {3.805745046911089*^9, 3.805745058956472*^9}, 
   3.8057641531660347`*^9, 3.8057642343390627`*^9, {3.80581426860111*^9, 
   3.805814275820133*^9}, {3.805814306569601*^9, 3.8058143108174677`*^9}, {
   3.80582369956715*^9, 3.8058237002226753`*^9}, {3.809286419626443*^9, 
   3.8092864234973087`*^9}, {3.8093679713192043`*^9, 
   3.8093679778333235`*^9}, {3.8093680321921363`*^9, 3.809368041827707*^9}, {
   3.809368227526821*^9, 3.8093682402947006`*^9}, {3.8095596250769835`*^9, 
   3.80955965179096*^9}, {3.8095597191690254`*^9, 3.8095597197545424`*^9}, {
   3.809560343316156*^9, 3.8095603608410835`*^9}, {3.809620674622855*^9, 
   3.8096206782086525`*^9}, {3.809620779694278*^9, 3.8096208056520653`*^9}, {
   3.809620840467801*^9, 3.8096208408739014`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"0c17bfc0-5c66-405b-bff1-9ee9d4aed5c4"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.8096208461430674`*^9, 3.809620908180877*^9, 
  3.809620939934964*^9, 3.809620988346773*^9, 3.809621555651879*^9, 
  3.809621751805355*^9, 3.80962264348316*^9, 3.809629085086917*^9, 
  3.8096292132789397`*^9, 3.809630130390871*^9, 3.809719637056343*^9, 
  3.809812137167727*^9, 3.809960594672776*^9, 3.8099863298294973`*^9, 
  3.8099863673055067`*^9, 3.811868318417481*^9, 3.811868610521165*^9, 
  3.8118686721986437`*^9, 3.811868871959959*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"7dcf2a5d-91b9-426d-b490-c31eaae0fbeb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining zeroth order flow fields", "Subsection",
 CellChangeTimes->{{3.809620815608268*^9, 
  3.8096208182398624`*^9}},ExpressionUUID->"4ed1d834-ea65-4d52-a3a8-\
ae7dd6fb7c8c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getUsquirmer0", " ", "[", 
    RowBox[{"i_", ",", "p_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "k", ",", "l"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "/", "3"}], " ", 
        RowBox[{"p", "[", "i", "]"}]}], "+", 
       RowBox[{
        RowBox[{"p", "[", "j", "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", "i", "]"}], 
           RowBox[{"r", "[", "j", "]"}], 
           RowBox[{"invr", "[", "5", "]"}]}], "-", 
          RowBox[{
           RowBox[{"delta", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{
            RowBox[{"invr", "[", "3", "]"}], "/", "3"}]}]}], ")"}]}], " ", 
       "+", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"invr", "[", "4", "]"}], "-", 
          RowBox[{"invr", "[", "2", "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"p", "[", "j", "]"}], 
           RowBox[{"r", "[", "j", "]"}], 
           RowBox[{"p", "[", "k", "]"}], 
           RowBox[{"r", "[", "k", "]"}], 
           RowBox[{"invr", "[", "2", "]"}]}], "-", "1"}], ")"}], " ", 
        RowBox[{"r", "[", "i", "]"}], 
        RowBox[{"invr", "[", "1", "]"}]}], "+", "\[IndentingNewLine]", " ", 
       RowBox[{"\[Xi]", " ", 
        RowBox[{"invr", "[", "5", "]"}], 
        RowBox[{"r", "[", "k", "]"}], 
        RowBox[{"p", "[", "k", "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "j", "]"}], 
           RowBox[{"r", "[", "j", "]"}], 
           RowBox[{"r", "[", "i", "]"}], 
           RowBox[{"invr", "[", "2", "]"}]}], "-", 
          RowBox[{"p", "[", "i", "]"}]}], ")"}]}], " ", "-", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{"3", "\[Zeta]", " ", 
        RowBox[{"eps", "[", 
         RowBox[{"i", ",", "j", ",", "k"}], "]"}], 
        RowBox[{"p", "[", "k", "]"}], 
        RowBox[{"p", "[", "l", "]"}], 
        RowBox[{"r", "[", "j", "]"}], 
        RowBox[{"r", "[", "l", "]"}], 
        RowBox[{"invr", "[", "5", "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Newtonian", " ", "flow", " ", "field", " ", "for", " ", "a", " ", 
    "neutral", " ", "squirmer"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLinearFlow", "[", 
    RowBox[{"i_", ",", "S_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"getNewIndex", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalGamma]", "*", 
       RowBox[{"S", "[", 
        RowBox[{"i", ",", "j"}], "]"}], 
       RowBox[{"r", "[", "j", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "i", " ", "is", " ", "the", " ", "index", " ", "and", " ", "S", " ", "is", 
    " ", "the", " ", "constant", " ", "we", " ", "use", " ", "for", " ", 
    "our", " ", "linear", " ", "flow"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUsquirmer0", " ", "[", 
    RowBox[{
     RowBox[{"idx", "[", "1", "]"}], ",", "p"}], "]"}], " ", "//", 
   "contract"}], "//", "prettyprint"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"partialr", "[", 
     RowBox[{
      RowBox[{"getUsquirmer0", " ", "[", 
       RowBox[{
        RowBox[{"idx", "[", "1", "]"}], ",", "p"}], "]"}], ",", 
      RowBox[{"idx", "[", "1", "]"}]}], "]"}], "//", "contract"}], "//", 
   "prettyprint"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "squirmer", " ", "flow", " ", "satisfies", " ", 
    "continuity"}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getUsquirmer0", "[", 
     RowBox[{
      RowBox[{"idx", "[", "1", "]"}], ",", "p"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"invr", "[", "_", "]"}], "\[RuleDelayed]", "1"}]}], "//", 
   "contract"}], " ", "//", "prettyprint"}]}], "Input",
 CellChangeTimes->{{3.8096208136398325`*^9, 3.809620843373457*^9}, {
   3.8096215082738423`*^9, 3.8096215098931894`*^9}, {3.809802131411614*^9, 
   3.8098021532677603`*^9}, {3.809802491456614*^9, 3.809802518422744*^9}, {
   3.8098117569659*^9, 3.809811850508095*^9}, {3.8098120686909227`*^9, 
   3.8098120694953747`*^9}, {3.809812122555942*^9, 3.809812127651936*^9}, {
   3.809812173793002*^9, 3.809812192600811*^9}, {3.8098122626787653`*^9, 
   3.809812273841126*^9}, {3.809812373361136*^9, 3.8098123752364807`*^9}, 
   3.809960588828128*^9, {3.811868050397726*^9, 3.811868060297014*^9}, {
   3.811868393548293*^9, 3.811868398798131*^9}, {3.811868523229438*^9, 
   3.811868568791123*^9}, {3.811868620440946*^9, 3.811868646840785*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"0c604f9a-6a83-4431-a706-42b548bb95fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "-", 
     FractionBox["1", 
      SuperscriptBox["r", "3"]]}], ")"}], " ", 
   SubscriptBox["p", "i"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["r", "5"]]}], "+", 
     FractionBox["1", 
      SuperscriptBox["r", "3"]]}], ")"}], " ", "\[Xi]", " ", 
   SubscriptBox["r", "i"]}], "-", 
  FractionBox[
   RowBox[{"\[Xi]", " ", 
    SubscriptBox["p", "i"], " ", 
    SubscriptBox["p", "j"], " ", 
    SubscriptBox["r", "j"]}], 
   SuperscriptBox["r", "5"]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "j"], " ", 
    SubscriptBox["r", "i"], " ", 
    SubscriptBox["r", "j"]}], 
   SuperscriptBox["r", "5"]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["5", 
      SuperscriptBox["r", "7"]], "-", 
     FractionBox["3", 
      SuperscriptBox["r", "5"]]}], ")"}], " ", "\[Xi]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["p", "k"], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"]}], "+", 
  FractionBox[
   RowBox[{"3", " ", "\[Zeta]", " ", 
    SubscriptBox["p", "j"], " ", 
    SubscriptBox["p", "l"], " ", 
    SubscriptBox["r", "k"], " ", 
    SubscriptBox["r", "l"], " ", 
    SubscriptBox["\[Epsilon]", 
     RowBox[{"i", ",", "j", ",", "k"}]]}], 
   SuperscriptBox["r", "5"]]}]], "Output",
 CellChangeTimes->{
  3.809559729353728*^9, 3.8095603500306625`*^9, 3.8096205720290184`*^9, 
   3.8096206879608192`*^9, 3.809620800472913*^9, 3.809620846214093*^9, 
   3.8096209081978893`*^9, 3.8096209400419884`*^9, 3.8096209884047856`*^9, 
   3.8096215110904646`*^9, {3.8096215525646544`*^9, 3.8096215557228947`*^9}, 
   3.809621751875371*^9, 3.809622643554185*^9, 3.8096290851139235`*^9, 
   3.8096292133629684`*^9, 3.8096301304598866`*^9, 3.809719638154139*^9, {
   3.809812130753601*^9, 3.809812194188403*^9}, {3.809812269524271*^9, 
   3.809812274516735*^9}, 3.809812376129798*^9, {3.809960590705099*^9, 
   3.809960595932824*^9}, 3.8099863314162893`*^9, 3.809986368406109*^9, {
   3.811868624072736*^9, 3.8118686740467243`*^9}, 3.811868874061908*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"1c1247a5-c88e-4a85-9792-0f7843d0762b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.809559729353728*^9, 3.8095603500306625`*^9, 3.8096205720290184`*^9, 
   3.8096206879608192`*^9, 3.809620800472913*^9, 3.809620846214093*^9, 
   3.8096209081978893`*^9, 3.8096209400419884`*^9, 3.8096209884047856`*^9, 
   3.8096215110904646`*^9, {3.8096215525646544`*^9, 3.8096215557228947`*^9}, 
   3.809621751875371*^9, 3.809622643554185*^9, 3.8096290851139235`*^9, 
   3.8096292133629684`*^9, 3.8096301304598866`*^9, 3.809719638154139*^9, {
   3.809812130753601*^9, 3.809812194188403*^9}, {3.809812269524271*^9, 
   3.809812274516735*^9}, 3.809812376129798*^9, {3.809960590705099*^9, 
   3.809960595932824*^9}, 3.8099863314162893`*^9, 3.809986368406109*^9, {
   3.811868624072736*^9, 3.8118686740467243`*^9}, 3.811868874063455*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"8b45c8d7-8ca5-47ec-bbae-926d59cfff72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["p", "i"]}], "-", 
  RowBox[{"\[Xi]", " ", 
   SubscriptBox["p", "i"], " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["r", "j"]}], "+", 
  RowBox[{
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"]}], "+", 
  RowBox[{"\[Xi]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["p", "k"], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"]}], "+", 
  RowBox[{"3", " ", "\[Zeta]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["p", "l"], " ", 
   SubscriptBox["r", "k"], " ", 
   SubscriptBox["r", "l"], " ", 
   SubscriptBox["\[Epsilon]", 
    RowBox[{"i", ",", "j", ",", "k"}]]}]}]], "Output",
 CellChangeTimes->{
  3.809559729353728*^9, 3.8095603500306625`*^9, 3.8096205720290184`*^9, 
   3.8096206879608192`*^9, 3.809620800472913*^9, 3.809620846214093*^9, 
   3.8096209081978893`*^9, 3.8096209400419884`*^9, 3.8096209884047856`*^9, 
   3.8096215110904646`*^9, {3.8096215525646544`*^9, 3.8096215557228947`*^9}, 
   3.809621751875371*^9, 3.809622643554185*^9, 3.8096290851139235`*^9, 
   3.8096292133629684`*^9, 3.8096301304598866`*^9, 3.809719638154139*^9, {
   3.809812130753601*^9, 3.809812194188403*^9}, {3.809812269524271*^9, 
   3.809812274516735*^9}, 3.809812376129798*^9, {3.809960590705099*^9, 
   3.809960595932824*^9}, 3.8099863314162893`*^9, 3.809986368406109*^9, {
   3.811868624072736*^9, 3.8118686740467243`*^9}, 3.811868874064937*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"009aba60-14e2-4479-862c-a98b60b55153"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Write down basic disturbance flows for sphere in Newtonian linear flows\
\>", "Subsection",
 CellChangeTimes->{{3.80962092417546*^9, 
  3.8096209315050964`*^9}},ExpressionUUID->"a1c544bb-0935-4c50-8d26-\
fa759a91929a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getDisturbanceFlowStrain", "[", 
    RowBox[{"i_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "k"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"5", "/", "6"}], " ", 
          RowBox[{"getStresslet", "[", 
           RowBox[{"i", ",", "j", ",", "k"}], "]"}], 
          RowBox[{"e", "[", 
           RowBox[{"j", ",", "k"}], "]"}], "*", "\[CapitalGamma]"}], "+", 
         RowBox[{
          RowBox[{"1", "/", "12"}], " ", 
          RowBox[{"laplacer", "[", 
           RowBox[{"getStresslet", "[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
          RowBox[{"e", "[", 
           RowBox[{"j", ",", "k"}], "]"}], "*", "\[CapitalGamma]"}]}], "//", 
        "contract"}], "//", "renumberUnique"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "disturbance", " ", "flow", " ", "for", " ", "a", " ", "particle", " ", 
    "in", " ", "straining", " ", "flow"}], " ", "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getDisturbanceFlowRotation", "[", 
    RowBox[{"i_", ",", "o_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "k"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"getRotlet", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], 
         RowBox[{"o", "[", 
          RowBox[{"j", ",", "k"}], "]"}], "*", "\[CapitalGamma]"}], "//", 
        "contract"}], "//", "renumberUnique"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "disturbance", " ", "flow", " ", "for", " ", "a", " ", "particle", " ", 
    "in", " ", "a", " ", "vortical", " ", "flow"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getDisturbanceFlowRotation", "[", 
   RowBox[{
    RowBox[{"idx", "[", "1", "]"}], ",", "o"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getLinearFlow", "[", 
      RowBox[{
       RowBox[{"idx", "[", "1", "]"}], ",", "o"}], "]"}], "+", "%"}], "/.", 
    RowBox[{
     RowBox[{"invr", "[", "_", "]"}], "\[RuleDelayed]", "1"}]}], " ", "//", 
   "contract"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"check", " ", "bc"}], " ", "-", " ", 
     RowBox[{"evaluate", " ", "at", " ", "r"}]}], "=", 
    RowBox[{
     RowBox[{
     "1.", " ", "should", " ", "be", " ", "0", " ", "cause", " ", "no"}], "-", 
     RowBox[{"slip", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getDisturbanceFlowStrain", "[", 
   RowBox[{
    RowBox[{"idx", "[", "1", "]"}], ",", "e"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getLinearFlow", "[", 
     RowBox[{
      RowBox[{"idx", "[", "1", "]"}], ",", "e"}], "]"}], "+", "%"}], "/.", 
   RowBox[{
    RowBox[{"invr", "[", "_", "]"}], "\[RuleDelayed]", "1"}]}], " ", "//", 
  "contract", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"check", " ", "bc"}], " ", "-", " ", 
     RowBox[{"evaluate", " ", "at", " ", "r"}]}], "=", 
    RowBox[{
     RowBox[{
     "1.", " ", "should", " ", "be", " ", "0", " ", "cause", " ", "no"}], "-", 
     RowBox[{"slip", "."}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.788546378285857*^9, 3.788546387616968*^9}, 
   3.788546522137372*^9, {3.78854776456176*^9, 3.788547770477894*^9}, {
   3.8057480781413937`*^9, 3.805748109009865*^9}, {3.809286425127675*^9, 
   3.809286426454973*^9}, {3.8093681101634417`*^9, 3.8093681491928043`*^9}, {
   3.809368291741229*^9, 3.8093683163655667`*^9}, {3.8095603974029293`*^9, 
   3.8095604419505544`*^9}, 3.809620668805558*^9, 3.8096209333384953`*^9, {
   3.8096215947065496`*^9, 3.809621605464932*^9}, {3.809621636564824*^9, 
   3.8096216797233953`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"d8007271-49ae-457a-88dd-36c577ece5e7"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.809560446003462*^9, 3.8096205721110373`*^9, {3.8096206692416463`*^9, 
   3.8096206884449387`*^9}, 3.809620846294102*^9, 3.8096209082238855`*^9, 
   3.8096209401550136`*^9, 3.8096209884718103`*^9, {3.809621543380618*^9, 
   3.809621555804903*^9}, 3.809621606025055*^9, {3.8096216681758256`*^9, 
   3.8096216800744743`*^9}, 3.809621751953388*^9, 3.8096226436301928`*^9, 
   3.8096290851459303`*^9, 3.8096292134539795`*^9, 3.8096301305249014`*^9, 
   3.809719639477294*^9, 3.809960597723755*^9, 3.8099864007855043`*^9, 
   3.811868675813377*^9, 3.811868876459461*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"8b392ecf-7c10-4d8b-acc1-578298fdffe1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.809560446003462*^9, 3.8096205721110373`*^9, {3.8096206692416463`*^9, 
   3.8096206884449387`*^9}, 3.809620846294102*^9, 3.8096209082238855`*^9, 
   3.8096209401550136`*^9, 3.8096209884718103`*^9, {3.809621543380618*^9, 
   3.809621555804903*^9}, 3.809621606025055*^9, {3.8096216681758256`*^9, 
   3.8096216800744743`*^9}, 3.809621751953388*^9, 3.8096226436301928`*^9, 
   3.8096290851459303`*^9, 3.8096292134539795`*^9, 3.8096301305249014`*^9, 
   3.809719639477294*^9, 3.809960597723755*^9, 3.8099864007855043`*^9, 
   3.811868675813377*^9, 3.8118688764614573`*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"3e28643a-1b67-4fd8-a391-2b63d45b8c7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "that", " ", "the", " ", "disturbance", " ", "flow", " ", 
    "from", " ", "the", " ", "external", " ", "linear", " ", "flow", " ", 
    "satisfies", " ", "continuity"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"partialr", "[", 
      RowBox[{
       RowBox[{"getDisturbanceFlowStrain", "[", 
        RowBox[{
         RowBox[{"idx", "[", "1", "]"}], ",", "e"}], "]"}], ",", 
       RowBox[{"idx", "[", "1", "]"}]}], "]"}], "//", "contract"}], "//", 
    "prettyprint"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"partialr", "[", 
      RowBox[{
       RowBox[{"getDisturbanceFlowRotation", "[", 
        RowBox[{
         RowBox[{"idx", "[", "1", "]"}], ",", "e"}], "]"}], ",", 
       RowBox[{"idx", "[", "1", "]"}]}], "]"}], "//", "contract"}], "//", 
    "prettyprint"}]}]}]], "Input",
 CellChangeTimes->{{3.8095604631344852`*^9, 3.809560479584629*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"fd438e3d-8a14-43a5-9b97-f695f1237389"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.788547818246923*^9, {3.788638765015131*^9, 3.788638769349243*^9}, 
   3.788638903607185*^9, 3.7886599170549498`*^9, 3.789844667268746*^9, 
   3.789845296343433*^9, 3.789847164118869*^9, 3.8057341020545197`*^9, 
   3.8057434601600933`*^9, 3.805745063434847*^9, {3.805748079130247*^9, 
   3.8057481097590103`*^9}, 3.805750410709491*^9, 3.805764157905365*^9, 
   3.805764297595365*^9, 3.805807166139406*^9, 3.805809670137212*^9, 
   3.805810616974032*^9, 3.8058142835213423`*^9, 3.8058143183569307`*^9, 
   3.805823665222721*^9, 3.805823704089838*^9, 3.808050032389553*^9, 
   3.8092865365416017`*^9, {3.809286827233099*^9, 3.809286855174369*^9}, 
   3.809286886658408*^9, 3.809286942230847*^9, 3.8092881451853905`*^9, 
   3.809288243893032*^9, 3.8092908330117483`*^9, 3.8092947919196167`*^9, 
   3.809367873007228*^9, 3.809559525559372*^9, {3.8095604195407343`*^9, 
   3.8095604476798363`*^9}, 3.8095604825732994`*^9, 3.8096205721840534`*^9, 
   3.809620688686984*^9, 3.8096208463691187`*^9, 3.8096209083739204`*^9, 
   3.8096209402640476`*^9, 3.809620988531824*^9, 3.809621555891924*^9, 
   3.809621752030406*^9, 3.8096226437212133`*^9, 3.8096290853589787`*^9, 
   3.8096292135429993`*^9, 3.809630130588916*^9, 3.809719640957444*^9, 
   3.809986402929913*^9, 3.811868678103606*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"cd2dda8c-0b3a-4747-8f5f-8a35685051e0"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.788547818246923*^9, {3.788638765015131*^9, 3.788638769349243*^9}, 
   3.788638903607185*^9, 3.7886599170549498`*^9, 3.789844667268746*^9, 
   3.789845296343433*^9, 3.789847164118869*^9, 3.8057341020545197`*^9, 
   3.8057434601600933`*^9, 3.805745063434847*^9, {3.805748079130247*^9, 
   3.8057481097590103`*^9}, 3.805750410709491*^9, 3.805764157905365*^9, 
   3.805764297595365*^9, 3.805807166139406*^9, 3.805809670137212*^9, 
   3.805810616974032*^9, 3.8058142835213423`*^9, 3.8058143183569307`*^9, 
   3.805823665222721*^9, 3.805823704089838*^9, 3.808050032389553*^9, 
   3.8092865365416017`*^9, {3.809286827233099*^9, 3.809286855174369*^9}, 
   3.809286886658408*^9, 3.809286942230847*^9, 3.8092881451853905`*^9, 
   3.809288243893032*^9, 3.8092908330117483`*^9, 3.8092947919196167`*^9, 
   3.809367873007228*^9, 3.809559525559372*^9, {3.8095604195407343`*^9, 
   3.8095604476798363`*^9}, 3.8095604825732994`*^9, 3.8096205721840534`*^9, 
   3.809620688686984*^9, 3.8096208463691187`*^9, 3.8096209083739204`*^9, 
   3.8096209402640476`*^9, 3.809620988531824*^9, 3.809621555891924*^9, 
   3.809621752030406*^9, 3.8096226437212133`*^9, 3.8096290853589787`*^9, 
   3.8096292135429993`*^9, 3.809630130588916*^9, 3.809719640957444*^9, 
   3.809986402929913*^9, 3.8118686781047792`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"9b4c32a6-1afb-44bf-becf-f669d8e1e72a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solution for flow around sphere in squirmer flow + linear flow by \
superposition \
\>", "Subsection",
 CellChangeTimes->{{3.809620911109537*^9, 
  3.809620919082327*^9}},ExpressionUUID->"1ffb09eb-fec8-460f-b8e4-\
a791e649bab9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getuinfinity", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"getLinearFlow", "[", 
     RowBox[{"i", ",", "e"}], "]"}], "+", 
    RowBox[{"getLinearFlow", "[", 
     RowBox[{"i", ",", "o"}], "]"}]}]}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "general", " ", "linear", " ", "flow", " ", "can", " ", "be", " ", 
    "decomposed", " ", "into", " ", "symmetric", " ", "and", " ", 
    "antisymmetric", " ", "part"}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getudisturbance", "[", "i_", "]"}], ":=", 
   RowBox[{"getDisturbanceFlowStrain", "[", 
    RowBox[{"i", ",", "e"}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "disturbance", " ", "flow", " ", "of", " ", "a", " ", "passive", " ", 
    RowBox[{"particle", ".", " ", "we"}], " ", 
    RowBox[{"don", "'"}], "t", " ", "add", " ", "the", " ", "disturbance", 
    " ", "flow", " ", "of", " ", "the", " ", "rotation", " ", "because", " ", 
    "the", " ", "particle", " ", "is", " ", 
    RowBox[{"rotating", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getu", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getuinfinity", "[", "i", "]"}], "+", 
     RowBox[{"getudisturbance", "[", "i", "]"}], "+", 
     RowBox[{"getUsquirmer0", "[", 
      RowBox[{"i", ",", "p"}], "]"}]}], "//", "contract"}], "//", 
   "renumberUnique"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getu", "[", 
     RowBox[{"idx", "[", "1", "]"}], "]"}], "//", "contract"}], "//", 
   "prettyprint"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "print", " ", "out", " ", "velocity", " ", "to", " ", "compare", " ", "to",
     " ", "what", " ", "is", " ", "known"}], " ", "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getu", "[", 
      RowBox[{"idx", "[", "1", "]"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"invr", "[", "_", "]"}], "\[RuleDelayed]", "1"}]}], "//", 
    "contract"}], " ", "//", "prettyprint"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "no"}], "-", 
    RowBox[{"slip", " ", 
     RowBox[{"condition", ".", " ", "should"}], " ", "recover", " ", 
     "squirmer", " ", "BC"}], " ", "+", " ", 
    RowBox[{"rigid", " ", "body", " ", "rotation"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.788546394136842*^9, 3.78854649686058*^9}, {
   3.788546527560069*^9, 3.7885465470062838`*^9}, {3.7887106878494673`*^9, 
   3.788710691837213*^9}, {3.788710851837182*^9, 3.7887108682064257`*^9}, {
   3.8057434682176857`*^9, 3.8057434684226027`*^9}, {3.8057436868261223`*^9, 
   3.8057436903792477`*^9}, {3.805744259491712*^9, 3.805744260131475*^9}, {
   3.805745621961404*^9, 3.8057456225739107`*^9}, {3.805748112612154*^9, 
   3.805748144336961*^9}, {3.805815232615796*^9, 3.805815235711713*^9}, {
   3.809286428301388*^9, 3.809286429769717*^9}, {3.80936858397371*^9, 
   3.8093685898420315`*^9}, {3.8093686412717648`*^9, 3.809368653639553*^9}, {
   3.8093687600107937`*^9, 3.809368854169649*^9}, 3.8095596144756083`*^9, 
   3.8096206655948343`*^9, 3.809620921165799*^9, {3.8096217794875364`*^9, 
   3.809621782727245*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"606be2d1-13d1-4005-b1b2-0a9cc225efa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "-", 
     FractionBox["1", 
      SuperscriptBox["r", "3"]]}], ")"}], " ", 
   SubscriptBox["p", "i"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["r", "5"]]}], "+", 
     FractionBox["1", 
      SuperscriptBox["r", "3"]]}], ")"}], " ", "\[Xi]", " ", 
   SubscriptBox["r", "i"]}], "-", 
  FractionBox[
   RowBox[{"\[Xi]", " ", 
    SubscriptBox["p", "i"], " ", 
    SubscriptBox["p", "j"], " ", 
    SubscriptBox["r", "j"]}], 
   SuperscriptBox["r", "5"]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "j"], " ", 
    SubscriptBox["r", "i"], " ", 
    SubscriptBox["r", "j"]}], 
   SuperscriptBox["r", "5"]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["5", 
      SuperscriptBox["r", "7"]], "-", 
     FractionBox["3", 
      SuperscriptBox["r", "5"]]}], ")"}], " ", "\[Xi]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["p", "k"], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[CapitalGamma]", "-", 
     FractionBox["\[CapitalGamma]", 
      SuperscriptBox["r", "5"]]}], ")"}], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "j"}]]}], "+", 
  RowBox[{
   FractionBox["5", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["r", "7"]], "-", 
     FractionBox["1", 
      SuperscriptBox["r", "5"]]}], ")"}], " ", "\[CapitalGamma]", " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]]}], "+", 
  RowBox[{"\[CapitalGamma]", " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["o", 
    RowBox[{"i", ",", "j"}]]}], "+", 
  FractionBox[
   RowBox[{"3", " ", "\[Zeta]", " ", 
    SubscriptBox["p", "j"], " ", 
    SubscriptBox["p", "l"], " ", 
    SubscriptBox["r", "k"], " ", 
    SubscriptBox["r", "l"], " ", 
    SubscriptBox["\[Epsilon]", 
     RowBox[{"i", ",", "j", ",", "k"}]]}], 
   SuperscriptBox["r", "5"]]}]], "Output",
 CellChangeTimes->{
  3.805814320193615*^9, 3.8058145274017344`*^9, 3.805815236435259*^9, 
   3.805823666768486*^9, 3.8058237062954397`*^9, 3.8080500335878077`*^9, 
   3.809286536617618*^9, {3.8092868274141397`*^9, 3.8092868553284135`*^9}, 
   3.8092868868314466`*^9, 3.809286942455906*^9, 3.809288145375434*^9, 
   3.809288244113084*^9, 3.809290833073763*^9, 3.8092947920116377`*^9, 
   3.8093678731062503`*^9, 3.8095595256533937`*^9, 3.809620572250078*^9, 
   3.809620688933049*^9, 3.8096208464531374`*^9, 3.80962090846194*^9, 
   3.809620940373073*^9, 3.809620988594838*^9, 3.8096215559799438`*^9, 
   3.809621752107424*^9, 3.8096226437992306`*^9, 3.80962908647423*^9, 
   3.809629214679256*^9, 3.8096301306579323`*^9, 3.80971964196346*^9, 
   3.809986404923661*^9, 3.811868679973234*^9, 3.811868883878792*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"91990c79-5941-4322-b72d-3a51b0e60d3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["p", "i"]}], "-", 
  RowBox[{"\[Xi]", " ", 
   SubscriptBox["p", "i"], " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["r", "j"]}], "+", 
  RowBox[{
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"]}], "+", 
  RowBox[{"\[Xi]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["p", "k"], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"]}], "+", 
  RowBox[{"\[CapitalGamma]", " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["o", 
    RowBox[{"i", ",", "j"}]]}], "+", 
  RowBox[{"3", " ", "\[Zeta]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["p", "l"], " ", 
   SubscriptBox["r", "k"], " ", 
   SubscriptBox["r", "l"], " ", 
   SubscriptBox["\[Epsilon]", 
    RowBox[{"i", ",", "j", ",", "k"}]]}]}]], "Output",
 CellChangeTimes->{
  3.805814320193615*^9, 3.8058145274017344`*^9, 3.805815236435259*^9, 
   3.805823666768486*^9, 3.8058237062954397`*^9, 3.8080500335878077`*^9, 
   3.809286536617618*^9, {3.8092868274141397`*^9, 3.8092868553284135`*^9}, 
   3.8092868868314466`*^9, 3.809286942455906*^9, 3.809288145375434*^9, 
   3.809288244113084*^9, 3.809290833073763*^9, 3.8092947920116377`*^9, 
   3.8093678731062503`*^9, 3.8095595256533937`*^9, 3.809620572250078*^9, 
   3.809620688933049*^9, 3.8096208464531374`*^9, 3.80962090846194*^9, 
   3.809620940373073*^9, 3.809620988594838*^9, 3.8096215559799438`*^9, 
   3.809621752107424*^9, 3.8096226437992306`*^9, 3.80962908647423*^9, 
   3.809629214679256*^9, 3.8096301306579323`*^9, 3.80971964196346*^9, 
   3.809986404923661*^9, 3.811868679973234*^9, 3.811868883880677*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"d64f4dd2-18e9-4286-81b4-3376a61aab71"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining gradients of flow at infinity ", "Subsection",
 CellChangeTimes->{{3.8096208962332287`*^9, 
  3.809620902087515*^9}},ExpressionUUID->"09eda905-6954-478c-8894-\
a448f1406946"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"getGradientInfinity", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"partialr", "[", 
     RowBox[{
      RowBox[{"getuinfinity", "[", "i", "]"}], ",", "j"}], "]"}], "//", 
    "contract"}], "//", "renumberUnique"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getStrainInfinity", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"getGradientInfinity", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"getGradientInfinity", "[", 
       RowBox[{"j", ",", "i"}], "]"}]}]}], "//", "contract"}], "//", 
   "renumberUnique"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getGradientInfinity", "[", 
   RowBox[{
    RowBox[{"idx", "[", "1", "]"}], ",", 
    RowBox[{"idx", "[", "2", "]"}]}], "]"}], "//", 
  "prettyprint"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getStrainInfinity", "[", 
   RowBox[{
    RowBox[{"idx", "[", "1", "]"}], ",", 
    RowBox[{"idx", "[", "2", "]"}]}], "]"}], "//", "prettyprint"}]}], "Input",\

 CellChangeTimes->{{3.805748170004764*^9, 3.805748247891905*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"ec4f4123-b675-4b80-98b8-6f17b590741e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]", " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "j"}]]}], "+", 
  RowBox[{"\[CapitalGamma]", " ", 
   SubscriptBox["o", 
    RowBox[{"i", ",", "j"}]]}]}]], "Output",
 CellChangeTimes->{{3.805748231733963*^9, 3.805748248267912*^9}, 
   3.8057504135260983`*^9, 3.8057641613648033`*^9, 3.8057644396903543`*^9, 
   3.8058071705676117`*^9, 3.805809673054433*^9, 3.8058106201488037`*^9, 
   3.805814288798966*^9, 3.8058143326122313`*^9, 3.8058145263668213`*^9, 
   3.805815241854362*^9, 3.805823668740526*^9, 3.80582370815283*^9, 
   3.808050034839457*^9, 3.8092865367836556`*^9, {3.8092868276071835`*^9, 
   3.809286855477437*^9}, 3.809286887007496*^9, 3.809286942697961*^9, 
   3.809288145571478*^9, 3.8092882443421345`*^9, 3.8092908338433013`*^9, 
   3.80929479214767*^9, 3.809367873340303*^9, 3.8095595258694425`*^9, 
   3.8096205723861084`*^9, 3.8096206894371533`*^9, 3.8096208465521593`*^9, 
   3.809620908544958*^9, 3.809620940486088*^9, 3.809620988658843*^9, 
   3.8096215560659723`*^9, 3.8096217521854415`*^9, 3.8096226438722477`*^9, 
   3.8096290889207816`*^9, 3.8096292171558247`*^9, 3.809630130769966*^9, 
   3.809719643375692*^9, 3.8099864090913343`*^9, 3.811868681890609*^9, 
   3.811868885619184*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"6c818846-16ab-4169-8f3e-2644edba7ccf"],

Cell[BoxData[
 RowBox[{"\[CapitalGamma]", " ", 
  SubscriptBox["e", 
   RowBox[{"i", ",", "j"}]]}]], "Output",
 CellChangeTimes->{{3.805748231733963*^9, 3.805748248267912*^9}, 
   3.8057504135260983`*^9, 3.8057641613648033`*^9, 3.8057644396903543`*^9, 
   3.8058071705676117`*^9, 3.805809673054433*^9, 3.8058106201488037`*^9, 
   3.805814288798966*^9, 3.8058143326122313`*^9, 3.8058145263668213`*^9, 
   3.805815241854362*^9, 3.805823668740526*^9, 3.80582370815283*^9, 
   3.808050034839457*^9, 3.8092865367836556`*^9, {3.8092868276071835`*^9, 
   3.809286855477437*^9}, 3.809286887007496*^9, 3.809286942697961*^9, 
   3.809288145571478*^9, 3.8092882443421345`*^9, 3.8092908338433013`*^9, 
   3.80929479214767*^9, 3.809367873340303*^9, 3.8095595258694425`*^9, 
   3.8096205723861084`*^9, 3.8096206894371533`*^9, 3.8096208465521593`*^9, 
   3.809620908544958*^9, 3.809620940486088*^9, 3.809620988658843*^9, 
   3.8096215560659723`*^9, 3.8096217521854415`*^9, 3.8096226438722477`*^9, 
   3.8096290889207816`*^9, 3.8096292171558247`*^9, 3.809630130769966*^9, 
   3.809719643375692*^9, 3.8099864090913343`*^9, 3.811868681890609*^9, 
   3.81186888562057*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"197e9261-524c-4b5d-89d5-ec37b043ac89"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining gradients of zeroth order flow", "Subsection",
 CellChangeTimes->{{3.8096208875042753`*^9, 
  3.8096208913511286`*^9}},ExpressionUUID->"53810cd1-51bf-4cb7-b8de-\
680239455427"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getGradient", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"partialr", "[", 
     RowBox[{
      RowBox[{"getu", "[", "i", "]"}], ",", "j"}], "]"}], "//", "contract"}], 
   "//", "renumberUnique"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getStrain", " ", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"getGradient", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"getGradient", "[", 
       RowBox[{"j", ",", "i"}], "]"}]}]}], "//", "contract"}], "//", 
   "renumberUnique"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.788546667825611*^9, 3.788546699308255*^9}, {
   3.789845304924767*^9, 3.789845313056497*^9}, 3.789845947675214*^9, {
   3.805746344347249*^9, 3.805746347276017*^9}, 3.805746574315392*^9, {
   3.805748156319721*^9, 3.8057481571526012`*^9}, {3.8058143396371193`*^9, 
   3.8058143547883673`*^9}, {3.805814458100222*^9, 3.805814511605153*^9}, {
   3.805815471742425*^9, 3.805815504458887*^9}, {3.8092864356700406`*^9, 
   3.809286436943325*^9}, 3.8096206447861977`*^9, 3.8096208934485984`*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"e299319a-415b-4fa6-9da0-a89381ed5e74"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute s_ij at infinity ", "Subsection",
 CellChangeTimes->{{3.8096219154238167`*^9, 
  3.8096219929711466`*^9}},ExpressionUUID->"0bc1d0e4-8152-4059-bc6e-\
7681433c02ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"getGradientInfinity", "[", 
         RowBox[{
          RowBox[{"idx", "[", "1", "]"}], ",", 
          RowBox[{"idx", "[", "2", "]"}]}], "]"}], "*", 
        RowBox[{"getStrainInfinity", "[", 
         RowBox[{
          RowBox[{"idx", "[", "2", "]"}], ",", 
          RowBox[{"idx", "[", "3", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"getGradientInfinity", "[", 
         RowBox[{
          RowBox[{"idx", "[", "3", "]"}], ",", 
          RowBox[{"idx", "[", "2", "]"}]}], "]"}], "*", 
        RowBox[{"getStrainInfinity", "[", 
         RowBox[{
          RowBox[{"idx", "[", "2", "]"}], ",", 
          RowBox[{"idx", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//", 
    "contract"}], "//", "renumber"}], "//", "prettyprint"}]], "Input",
 CellChangeTimes->{{3.8096219939613667`*^9, 3.809622004451713*^9}, {
  3.8096221056107607`*^9, 3.8096221624564548`*^9}, {3.80962224273835*^9, 
  3.80962224809555*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"1da00bd9-d6ee-497b-90d5-82ddbac9df02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   SuperscriptBox["\[CapitalGamma]", "2"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "l"}]], " ", 
   SubscriptBox["e", 
    RowBox[{"k", ",", "l"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["\[CapitalGamma]", "2"], " ", 
   SubscriptBox["e", 
    RowBox[{"k", ",", "l"}]], " ", 
   SubscriptBox["o", 
    RowBox[{"i", ",", "l"}]]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["\[CapitalGamma]", "2"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "l"}]], " ", 
   SubscriptBox["o", 
    RowBox[{"k", ",", "l"}]]}]}]], "Output",
 CellChangeTimes->{
  3.8096221634066763`*^9, {3.80962224511088*^9, 3.8096222484136205`*^9}, 
   3.8096226439692693`*^9, 3.8096290891238284`*^9, 3.8096292173378553`*^9, 
   3.8096301308479743`*^9, 3.809719646506547*^9, 3.809986413708909*^9, 
   3.811868686702098*^9, 3.8118688899478083`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"02836099-a66e-4554-97d6-9ed1ba32a584"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining auxiliary flow", "Subsection",
 CellChangeTimes->{{3.809620878258227*^9, 
  3.8096208826431956`*^9}},ExpressionUUID->"c8aecce3-b181-493b-a1c5-\
0492208ec681"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Auxiliary", " ", "flow", " ", "is", " ", "that", " ", "of", " ", "a", " ",
     "single", " ", "particle", " ", "translating", " ", "at", " ", "a", " ", 
    "velocity", " ", "V", " ", "in", " ", "quiescent", " ", "fluid"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getAuxG", " ", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "/", "4"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"invr", "[", "1", "]"}], "+", 
         RowBox[{
          RowBox[{"1", "/", "3"}], 
          RowBox[{"invr", "[", "3", "]"}]}]}], ")"}], 
       RowBox[{"delta", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"3", "/", "4"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"invr", "[", "3", "]"}], "-", 
         RowBox[{"invr", "[", "5", "]"}]}], ")"}], 
       RowBox[{"r", "[", "i", "]"}], 
       RowBox[{"r", "[", "j", "]"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"transfer", " ", "matrix"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getAuxV", "[", "i_", "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "j", "}"}], ",", 
      RowBox[{
       RowBox[{"j", "=", 
        RowBox[{"getNewIndex", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getAuxG", " ", "[", 
         RowBox[{"i", ",", "j"}], "]"}], 
        RowBox[{"V", "[", "j", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"auxillary", " ", "flow", " ", "field"}], ",", " ", "u"}], " ", 
    "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getAuxPartialG", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], " ", ":=", 
    RowBox[{"partialr", "[", 
     RowBox[{
      RowBox[{"getAuxG", "[", 
       RowBox[{"i", ",", "k"}], "]"}], ",", "j"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getAuxV", "[", 
      RowBox[{"idx", "[", "1", "]"}], "]"}], "//", "contract"}], "//", 
    "prettyprint", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "prettyprint", " ", "to", " ", "make", " ", "sure", " ", "G", " ", "is", 
      " ", "input", " ", "correctly"}], " ", "*)"}], " "}]}]}]], "Input",
 CellChangeTimes->{
  3.7884619765773897`*^9, {3.788462026412416*^9, 3.788462039234508*^9}, {
   3.78846207604821*^9, 3.788462091872225*^9}, {3.788462209660931*^9, 
   3.788462295121616*^9}, {3.7884623327496347`*^9, 3.788462361062106*^9}, {
   3.788462452145629*^9, 3.788462473445857*^9}, {3.7884625079702787`*^9, 
   3.788462520583447*^9}, {3.7884626821154757`*^9, 3.788462728935975*^9}, {
   3.788462965358757*^9, 3.7884629707657833`*^9}, {3.788463277460367*^9, 
   3.788463291638316*^9}, {3.7884690991851807`*^9, 3.78846920867601*^9}, {
   3.788469505851377*^9, 3.788469609762889*^9}, {3.788469646616947*^9, 
   3.788469663384924*^9}, {3.788544405334684*^9, 3.788544430864071*^9}, {
   3.788546592392775*^9, 3.788546640107873*^9}, {3.788638753800322*^9, 
   3.788638755529429*^9}, {3.789847188564569*^9, 3.789847197297068*^9}, {
   3.805746781494707*^9, 3.805746783167445*^9}, {3.805746983216731*^9, 
   3.805747045384626*^9}, {3.805747081992733*^9, 3.805747114125761*^9}, {
   3.805749847273663*^9, 3.805749894870397*^9}, {3.805749925725441*^9, 
   3.805749938581958*^9}, {3.805750363537154*^9, 3.805750401508526*^9}, {
   3.805765363039043*^9, 3.805765395888797*^9}, {3.809286438809745*^9, 
   3.8092864398839836`*^9}, {3.809369332631212*^9, 3.8093694221551647`*^9}, 
   3.8096206513156424`*^9, 3.80962088440259*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"8af5c6dd-2a0d-4b88-a8ad-3c7644b9a6ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["r", "3"]], "+", 
     FractionBox["3", "r"]}], ")"}], " ", 
   SubscriptBox["V", "i"]}], "+", 
  RowBox[{
   FractionBox["3", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["r", "5"]]}], "+", 
     FractionBox["1", 
      SuperscriptBox["r", "3"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["V", "j"]}]}]], "Output",
 CellChangeTimes->{{3.789847193987701*^9, 3.789847197549179*^9}, 
   3.8057341077870398`*^9, 3.8057467838867617`*^9, 3.805747104303162*^9, 
   3.8057497965984592`*^9, {3.8057498624112463`*^9, 3.805749904447013*^9}, 
   3.80574994072368*^9, {3.805750416147708*^9, 3.805750417900187*^9}, 
   3.805764165447032*^9, {3.805765363701432*^9, 3.805765386893033*^9}, 
   3.805766400245558*^9, 3.805807173724717*^9, {3.805809663343581*^9, 
   3.805809675688231*^9}, 3.805810623145196*^9, 3.805814291794972*^9, 
   3.8058144165417833`*^9, 3.805823671211195*^9, 3.805823711077796*^9, 
   3.80805003732121*^9, 3.8092865369386997`*^9, {3.809286827791225*^9, 
   3.809286855620469*^9}, 3.8092868871765337`*^9, 3.8092869429270124`*^9, 
   3.80928814575852*^9, 3.809288244566185*^9, 3.80929083413332*^9, 
   3.80929479224269*^9, 3.8093678735563517`*^9, 3.809559526100494*^9, 
   3.809620572511137*^9, 3.8096206585182543`*^9, 3.8096206896922092`*^9, 
   3.8096208466451907`*^9, 3.809620908637989*^9, 3.8096209406041155`*^9, 
   3.809620988746872*^9, 3.8096215561591606`*^9, 3.8096217522674694`*^9, 
   3.8096226440382843`*^9, 3.8096290892808623`*^9, 3.809629217447881*^9, 
   3.8096301309069877`*^9, 3.8097196488777847`*^9, 3.809986417915677*^9, 
   3.811868688968452*^9, 3.8118688915582523`*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"38110ed3-7449-4616-aba9-b14694c4ee74"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing O(Wi) term from O(1) terms", "Subsection",
 CellChangeTimes->{{3.8096208625067387`*^9, 
  3.809620869865362*^9}},ExpressionUUID->"687bcad0-a44e-4785-8413-\
fe4658e60a09"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "each", " ", "of", " ", "these", " ", "terms", " ", "is", " ", "from", 
     " ", "pencil"}], "-", 
    RowBox[{
    "paper", " ", "application", " ", "of", " ", "the", " ", "reciprocal", 
     " ", "theorem"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"term1", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{"idx", "[", "1", "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"idx", "[", "2", "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"getNewIndex", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"getu", "[", "k", "]"}], 
          RowBox[{"partialr", "[", 
           RowBox[{
            RowBox[{"getStrain", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", "k"}], "]"}]}], "//", 
         "contract"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term2", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{"idx", "[", "1", "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"idx", "[", "2", "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"getNewIndex", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"2", 
           RowBox[{"getGradient", "[", 
            RowBox[{"i", ",", "k"}], "]"}], 
           RowBox[{"getStrain", "[", 
            RowBox[{"k", ",", "j"}], "]"}]}], "+", 
          RowBox[{"2", 
           RowBox[{"getGradient", "[", 
            RowBox[{"j", ",", "k"}], "]"}], 
           RowBox[{"getStrain", "[", 
            RowBox[{"k", ",", "i"}], "]"}]}]}], "//", "contract"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term3", " ", "=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{"idx", "[", "1", "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"idx", "[", "2", "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"getNewIndex", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"getGradientInfinity", "[", 
            RowBox[{"i", ",", "k"}], "]"}], 
           RowBox[{"getStrainInfinity", "[", 
            RowBox[{"k", ",", "j"}], "]"}]}], " ", "-", 
          RowBox[{"2", "   ", 
           RowBox[{"getGradientInfinity", "[", 
            RowBox[{"j", ",", "k"}], "]"}], 
           RowBox[{"getStrainInfinity", "[", 
            RowBox[{"k", ",", "i"}], "]"}]}]}], "//", "contract"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sij", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Beta]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"term1", "+", "term2", "+", "term3"}], ")"}]}], "//", 
      "contract"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "sij", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.805747138252043*^9, 3.8057471768540077`*^9}, {
   3.805747597457395*^9, 3.805747633826646*^9}, {3.805747670363656*^9, 
   3.805747718915051*^9}, {3.805747752483335*^9, 3.8057478433220177`*^9}, {
   3.8057491272294827`*^9, 3.805749170183017*^9}, {3.80574920324498*^9, 
   3.805749236492125*^9}, {3.805749321782106*^9, 3.80574932322314*^9}, {
   3.805749670865451*^9, 3.805749676644244*^9}, {3.805752788618349*^9, 
   3.805752797937695*^9}, {3.805753298298655*^9, 3.805753369312593*^9}, {
   3.805763383937805*^9, 3.805763396368599*^9}, {3.8057645256060057`*^9, 
   3.805764529024919*^9}, {3.80576466545288*^9, 3.805764667334792*^9}, 
   3.805764776800604*^9, {3.805765140520482*^9, 3.80576517321786*^9}, {
   3.805765228431364*^9, 3.8057652471178637`*^9}, {3.805766413296052*^9, 
   3.805766415413566*^9}, 3.805766446035646*^9, 3.8058071768231783`*^9, 
   3.80580854748421*^9, {3.805808815026517*^9, 3.805808819283114*^9}, {
   3.8058090040783567`*^9, 3.80580900830015*^9}, {3.8058090482454453`*^9, 
   3.805809049593924*^9}, 3.805809361560978*^9, 3.805811044182803*^9, {
   3.8058132260353317`*^9, 3.805813226546631*^9}, {3.805813517698901*^9, 
   3.805813558607951*^9}, {3.8058136066388283`*^9, 3.805813625392296*^9}, {
   3.805813690274948*^9, 3.805813712078895*^9}, {3.805813777740137*^9, 
   3.805813894237566*^9}, {3.805813940760997*^9, 3.8058139425926943`*^9}, {
   3.805813983130577*^9, 3.8058140054220037`*^9}, 3.805814099971222*^9, {
   3.805814137314711*^9, 3.805814181050069*^9}, 3.805814221077241*^9, {
   3.805814440754807*^9, 3.8058144488082123`*^9}, {3.80581553596033*^9, 
   3.805815555135757*^9}, 3.805815615724428*^9, 3.805815660764179*^9, {
   3.8058159280256433`*^9, 3.805815952194581*^9}, {3.8092864416163735`*^9, 
   3.80928644330975*^9}, {3.809286824456477*^9, 3.8092868519676533`*^9}, {
   3.8092868840058146`*^9, 3.8092868840508246`*^9}, {3.8092869392471867`*^9, 
   3.8092869393502007`*^9}, {3.8092881401622677`*^9, 3.809288142696834*^9}, {
   3.8092908249824295`*^9, 3.809290826921547*^9}, {3.809290911552916*^9, 
   3.809290911781967*^9}, {3.809369441212263*^9, 3.809369453434924*^9}, 
   3.8096206554185686`*^9, {3.8096208719598284`*^9, 3.8096208723819313`*^9}, {
   3.8096226169972095`*^9, 3.8096226396032867`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"2b7f7d2c-d4de-4ee2-a9a9-8469e5115ec3"],

Cell[BoxData["790"], "Output",
 CellChangeTimes->{
  3.805749711930718*^9, 3.8057499043470182`*^9, 3.805750420599729*^9, 
   3.805752803212044*^9, {3.805753366064028*^9, 3.805753370916582*^9}, 
   3.80576339877345*^9, 3.805764169047152*^9, 3.8057645380873547`*^9, 
   3.8057646693956633`*^9, 3.805764778709077*^9, {3.805765150084021*^9, 
   3.805765175079801*^9}, {3.805765231197566*^9, 3.805765249127694*^9}, 
   3.805766417698317*^9, 3.8058071838349113`*^9, 3.805808550966239*^9, 
   3.805808821227174*^9, 3.8058090131917973`*^9, 3.805809052228972*^9, 
   3.805811051143511*^9, {3.805813228606824*^9, 3.8058132581808662`*^9}, 
   3.805813521912928*^9, {3.8058135612128153`*^9, 3.805813573876725*^9}, {
   3.805813608930705*^9, 3.805813627527977*^9}, 3.805813694182673*^9, 
   3.8058137355535994`*^9, {3.805813794519855*^9, 3.805813800414164*^9}, 
   3.8058138333278627`*^9, {3.8058139136671753`*^9, 3.805813944022471*^9}, {
   3.805813999669018*^9, 3.805814006847378*^9}, 3.805814101816689*^9, {
   3.805814138666991*^9, 3.805814182140761*^9}, {3.805814222511211*^9, 
   3.80581423832163*^9}, 3.805814295049799*^9, {3.8058144188752813`*^9, 
   3.805814449945222*^9}, {3.805815509418133*^9, 3.805815556475546*^9}, 
   3.80581561813533*^9, 3.805815664862309*^9, {3.805815930403862*^9, 
   3.805815954385459*^9}, 3.805823715615388*^9, 3.808050039935904*^9, 
   3.809286537029711*^9, {3.8092868278972497`*^9, 3.809286855702488*^9}, 
   3.809286887277546*^9, 3.80928694305204*^9, 3.809288145862543*^9, 
   3.809288244688222*^9, 3.8092908342793517`*^9, 3.809294792303713*^9, 
   3.809367873804407*^9, 3.8095595263335457`*^9, 3.809620572580143*^9, 
   3.809620658021146*^9, 3.809620691855698*^9, 3.8096208488196707`*^9, 
   3.809620910793465*^9, 3.809620942770603*^9, 3.809620990930355*^9, 
   3.8096215584305053`*^9, 3.8096217548810496`*^9, 3.809622646407819*^9, 
   3.809629091756421*^9, 3.809629219928439*^9, 3.8096301332335114`*^9, 
   3.809719652793775*^9, 3.8099864261850967`*^9, 3.8118687010446663`*^9, 
   3.811868905151744*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"dc8f5da1-1817-4484-8b0e-f14d3f4ce07a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating integrands", "Subsection",
 CellChangeTimes->{{3.80962085391682*^9, 
  3.809620856038305*^9}},ExpressionUUID->"ab05e828-1d0b-4d73-8fd4-\
81a346f1f9d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Volume", " ", "integral", " ", "of"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"G", " ", "=", " ", 
     RowBox[{
      RowBox[{"getAuxPartialG", "[", 
       RowBox[{
        RowBox[{"idx", "[", "1", "]"}], ",", 
        RowBox[{"idx", "[", "2", "]"}], ",", 
        RowBox[{"idx", "[", 
         RowBox[{"-", "1"}], "]"}]}], "]"}], "//", "contract"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integrand", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "G"}], " ", "sij"}], "//", "contract"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fluidVolumeIntegral", "[", "%", "]"}], "/.", 
        RowBox[{
         RowBox[{"idx", "[", 
          RowBox[{"-", "1"}], "]"}], "\[Rule]", 
         RowBox[{"idx", "[", "1", "]"}]}]}], "//", "contract"}], "//", 
      "renumber"}], "//", "contract"}], "//", "prettyprint"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "compute", " ", "volume", " ", "integral", " ", "to", " ", "recover", " ",
      "velocity"}], " ", "*)"}], " ", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7885368546866293`*^9, 3.788536855820202*^9}, 
   3.788544419782051*^9, {3.788544470437546*^9, 3.788544476270145*^9}, {
   3.788544566707546*^9, 3.788544567603441*^9}, {3.7885451394463263`*^9, 
   3.788545140480125*^9}, {3.7885468755558357`*^9, 3.788546879086478*^9}, {
   3.788547231312704*^9, 3.7885472918606663`*^9}, {3.788547426647897*^9, 
   3.78854742697962*^9}, {3.7885478769510098`*^9, 3.78854791660577*^9}, {
   3.788548581809*^9, 3.788548581989959*^9}, {3.788548704095438*^9, 
   3.788548738472287*^9}, {3.788548790748123*^9, 3.788548793879065*^9}, {
   3.788549045631834*^9, 3.7885490733286953`*^9}, {3.78854914293884*^9, 
   3.788549163687932*^9}, {3.788549207365382*^9, 3.7885492152683897`*^9}, {
   3.788549254126671*^9, 3.788549287998111*^9}, {3.788557151030294*^9, 
   3.788557181645986*^9}, {3.7886387586584597`*^9, 3.7886387609183693`*^9}, {
   3.788638794173478*^9, 3.78863886903153*^9}, {3.805746074211273*^9, 
   3.805746082088945*^9}, {3.805749757694536*^9, 3.805749771477705*^9}, {
   3.8057499466206007`*^9, 3.805750056517075*^9}, {3.8057501102878237`*^9, 
   3.805750126766302*^9}, {3.805750203883586*^9, 3.8057502229759283`*^9}, {
   3.8057503257799187`*^9, 3.8057503265087*^9}, 3.805750405656432*^9, {
   3.805750552154146*^9, 3.8057506002649193`*^9}, 3.805750647894347*^9, {
   3.8057536099778843`*^9, 3.8057536476224117`*^9}, {3.805753688067285*^9, 
   3.805753708972663*^9}, {3.805763129805874*^9, 3.805763139420578*^9}, {
   3.805763222396357*^9, 3.805763224527548*^9}, {3.805764567790709*^9, 
   3.8057645698799353`*^9}, 3.805764676321702*^9, {3.80576526413188*^9, 
   3.805765264439639*^9}, {3.805765400593211*^9, 3.805765402025258*^9}, {
   3.8057654461523542`*^9, 3.80576544647583*^9}, {3.805807200719013*^9, 
   3.8058072068153267`*^9}, 3.805807531199654*^9, {3.805807565822688*^9, 
   3.805807581755352*^9}, {3.805807782417049*^9, 3.8058078089313087`*^9}, {
   3.805808566943569*^9, 3.8058085670215683`*^9}, {3.8058086609452543`*^9, 
   3.8058086742056837`*^9}, {3.805808740640316*^9, 3.805808741177442*^9}, 
   3.8058087890624113`*^9, {3.805809106678598*^9, 3.805809135101728*^9}, {
   3.8058091718553267`*^9, 3.8058091774572268`*^9}, {3.805809260052908*^9, 
   3.805809261154385*^9}, {3.805809344529353*^9, 3.805809391978642*^9}, 
   3.805811046904912*^9, {3.805811086313748*^9, 3.8058111035872927`*^9}, {
   3.805813259420547*^9, 3.8058132738957853`*^9}, {3.805815678534363*^9, 
   3.805815679134274*^9}, {3.805815959533585*^9, 3.805816019383211*^9}, {
   3.808050020322364*^9, 3.8080500283112907`*^9}, {3.8092864475156994`*^9, 
   3.8092864483478756`*^9}, {3.809286686839692*^9, 3.8092866994805174`*^9}, {
   3.809286735565619*^9, 3.8092867412078924`*^9}, {3.809288129894973*^9, 
   3.809288133403767*^9}, {3.809288166510173*^9, 3.809288240653309*^9}, 
   3.8092908218668222`*^9, {3.8093694796778307`*^9, 3.8093694867150135`*^9}, 
   3.809620682923696*^9, {3.8096207214202814`*^9, 3.8096207428440676`*^9}, 
   3.809620858263788*^9, {3.8096209662558403`*^9, 3.809620970447774*^9}, {
   3.8099967810008907`*^9, 3.8099967826831636`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"c2590065-374c-4c09-858d-bc1ae23b7fb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["4", "5"], " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[Xi]", " ", 
   SubscriptBox["p", "i"]}], "+", 
  RowBox[{"2", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[CapitalGamma]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "j"}]]}]}]], "Output",
 CellChangeTimes->{{3.8058077971627274`*^9, 3.805807818799608*^9}, {
   3.80580856442843*^9, 3.805808576960409*^9}, 3.805808683845172*^9, 
   3.805808751201797*^9, 3.805808796104042*^9, 3.805808829246014*^9, 
   3.80580906702354*^9, {3.80580911910495*^9, 3.805809146909442*^9}, 
   3.805809189056836*^9, 3.8058092717981167`*^9, {3.805811079380096*^9, 
   3.805811114828815*^9}, 3.805813237628477*^9, 3.805813268284012*^9, {
   3.805815672208791*^9, 3.805815688316224*^9}, {3.805815971087577*^9, 
   3.805815991954123*^9}, 3.80581602476378*^9, 3.80582372219353*^9, {
   3.8080500209378843`*^9, 3.808050044674999*^9}, 3.8092865394212503`*^9, {
   3.8092866874658318`*^9, 3.8092867000616484`*^9}, {3.809286747848378*^9, 
   3.809286752952529*^9}, {3.8092868300097356`*^9, 3.809286857784958*^9}, 
   3.809286889282998*^9, 3.8092869451106267`*^9, {3.809288148077052*^9, 
   3.8092882136932697`*^9}, 3.809288247113762*^9, 3.809290836573763*^9, 
   3.8092947947012453`*^9, 3.809367876729067*^9, 3.809559528869439*^9, 
   3.8096205749916954`*^9, {3.8096206983101625`*^9, 3.8096207490724764`*^9}, 
   3.8096208546169877`*^9, 3.8096209169088435`*^9, {3.8096209489219894`*^9, 
   3.809620996729672*^9}, 3.8096215648899612`*^9, 3.8096217612724895`*^9, 
   3.809622650244684*^9, 3.8096290959713707`*^9, 3.8096292240413666`*^9, 
   3.8096301369913597`*^9, 3.80971965631958*^9, 3.809986434607996*^9, 
   3.809996788802767*^9, 3.811868735483856*^9, 3.811868767441407*^9, 
   3.811868919476511*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"f59b65b9-f80c-4e9c-83c7-f2d7a39b32e3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Try Anni\[CloseCurlyQuote]s derivation of the squirmer velocity", \
"Subsection",
 CellChangeTimes->{{3.809625176454757*^9, 
  3.8096251838834133`*^9}},ExpressionUUID->"a8f4ddbe-29a6-4fe4-ae17-\
b157141e002b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"get\[Sigma]E", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "k", "}"}], ",", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"getNewIndex", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Beta]"}], ")"}], "*", 
      RowBox[{"-", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"getu", "[", "k", "]"}], "*", 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"getStrain", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", "k"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"getGradient", "[", 
          RowBox[{"i", ",", "k"}], "]"}], 
         RowBox[{"getStrain", "[", 
          RowBox[{"k", ",", "j"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"getGradient", "[", 
          RowBox[{"j", ",", "k"}], "]"}], 
         RowBox[{"getStrain", "[", 
          RowBox[{"k", ",", "i"}], "]"}]}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"term1", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{"j", "=", 
       RowBox[{"getNewIndex", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "6"}], "/", "\[Pi]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"get\[Sigma]E", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"r", "[", "j", "]"}]}], ")"}], 
          RowBox[{"invr", "[", "1", "]"}]}], "//", "contract"}], "//", 
        "unitsphereIntegral"}], "//", "contract"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"term2", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"idx", "[", "1", "]"}]}], ";", 
       RowBox[{"j", "=", 
        RowBox[{"getNewIndex", "[", "]"}]}], ";", 
       RowBox[{"k", "=", 
        RowBox[{"getNewIndex", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "6"}], "/", "\[Pi]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"getAuxG", "[", 
              RowBox[{"i", ",", "j"}], "]"}], 
             RowBox[{"partialr", "[", 
              RowBox[{
               RowBox[{"get\[Sigma]E", "[", 
                RowBox[{"k", ",", "j"}], "]"}], ",", "k"}], "]"}]}], ")"}]}], 
          "//", "contract"}], "//", "fluidVolumeIntegral"}], "//", 
        "contract"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"term1", "//", "prettyprint"}], "\[IndentingNewLine]", 
 RowBox[{"term2", "//", "prettyprint"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"term1", "+", "term2"}], ")"}], "//", "prettyprint"}]}], "Input",
 CellChangeTimes->{{3.809625320960032*^9, 3.8096253325196047`*^9}, {
   3.809625410522002*^9, 3.809625422622695*^9}, {3.8096261999234877`*^9, 
   3.8096262262894163`*^9}, {3.809626264638982*^9, 3.8096263928959475`*^9}, {
   3.8096264277627296`*^9, 3.8096264443564425`*^9}, {3.8096286625453787`*^9, 
   3.8096286756573086`*^9}, {3.8096287130666795`*^9, 3.809628783519427*^9}, {
   3.8096288220670333`*^9, 3.809629039252587*^9}, {3.809629070162555*^9, 
   3.809629071332819*^9}, {3.8096291331068897`*^9, 3.809629140984665*^9}, {
   3.809629198898718*^9, 3.809629227967252*^9}, {3.8096293262552376`*^9, 
   3.809629440544812*^9}, {3.809629865828372*^9, 3.8096298719377394`*^9}, {
   3.809719858965279*^9, 3.809719877834712*^9}, 3.809992466722596*^9, 
   3.809992763449423*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"90126278-fa2d-4c79-a977-62d9f54e0980"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["8", "9"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[Xi]", " ", 
   SubscriptBox["p", "i"]}], "+", 
  RowBox[{
   FractionBox["4", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[CapitalGamma]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "j"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[CapitalGamma]", " ",
    "\[Zeta]", " ", 
   SubscriptBox["p", "k"], " ", 
   SubscriptBox["p", "l"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]], " ", 
   SubscriptBox["\[Epsilon]", 
    RowBox[{"i", ",", "j", ",", "l"}]]}]}]], "Output",
 CellChangeTimes->{3.8096293803533397`*^9, 3.8096296223277893`*^9, 
  3.8096300645921564`*^9, 3.809630316973936*^9, 3.809719796086892*^9, 
  3.8097199931239147`*^9, 3.8099873186884813`*^9, 3.8099933460459967`*^9, 
  3.809994209643112*^9, 3.81187088821941*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"36cff5e6-aaf0-40e0-a1e5-9348a17b23d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["46", "45"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[Xi]", " ", 
   SubscriptBox["p", "i"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[CapitalGamma]", "-", 
     RowBox[{"\[Beta]", " ", "\[CapitalGamma]"}]}], ")"}], " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "j"}]]}], "-", 
  RowBox[{
   FractionBox["11", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[CapitalGamma]", " ",
    "\[Zeta]", " ", 
   SubscriptBox["p", "k"], " ", 
   SubscriptBox["p", "l"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]], " ", 
   SubscriptBox["\[Epsilon]", 
    RowBox[{"i", ",", "j", ",", "l"}]]}]}]], "Output",
 CellChangeTimes->{3.8096293803533397`*^9, 3.8096296223277893`*^9, 
  3.8096300645921564`*^9, 3.809630316973936*^9, 3.809719796086892*^9, 
  3.8097199931239147`*^9, 3.8099873186884813`*^9, 3.8099933460459967`*^9, 
  3.809994209643112*^9, 3.811870888222569*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"398149ae-3364-4e3d-a6dd-4455e3c90bfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["2", "15"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[Xi]", " ", 
   SubscriptBox["p", "i"]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[CapitalGamma]", " ", 
   SubscriptBox["p", "j"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "j"}]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", "\[CapitalGamma]", " ",
    "\[Zeta]", " ", 
   SubscriptBox["p", "k"], " ", 
   SubscriptBox["p", "l"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]], " ", 
   SubscriptBox["\[Epsilon]", 
    RowBox[{"i", ",", "j", ",", "l"}]]}]}]], "Output",
 CellChangeTimes->{3.8096293803533397`*^9, 3.8096296223277893`*^9, 
  3.8096300645921564`*^9, 3.809630316973936*^9, 3.809719796086892*^9, 
  3.8097199931239147`*^9, 3.8099873186884813`*^9, 3.8099933460459967`*^9, 
  3.809994209643112*^9, 3.8118708882256737`*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"3cc23d9e-0f3d-41b0-a078-d3269181e1b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%", "*", "6", "*", "\[Pi]"}], "//", "contract"}], "//", 
  "prettyprint"}]], "Input",
 CellChangeTimes->{{3.809630342170572*^9, 3.809630346152452*^9}, {
  3.809996740685782*^9, 3.809996744942342*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"031bae21-cfb2-4cfb-96d2-0fe245151cbe"],

Cell[BoxData[
 RowBox[{
  FractionBox["2", "5"], " ", "\[Pi]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "\[Xi]", " ", 
     SubscriptBox["p", "i"]}], "+", 
    RowBox[{"5", " ", "\[CapitalGamma]", " ", 
     SubscriptBox["p", "j"], " ", 
     SubscriptBox["e", 
      RowBox[{"i", ",", "j"}]]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8096303474547415`*^9, 3.809720092294072*^9, 
  3.809992421972065*^9, 3.809996745271109*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"77716806-d457-458e-be2c-e541a0582216"]
}, Open  ]],

Cell["\<\
This integral is off by a factor of 7 from the result from Eric\
\[CloseCurlyQuote]s formula above. \
\>", "Text",
 CellChangeTimes->{{3.809630372469336*^9, 
  3.8096303878437753`*^9}},ExpressionUUID->"42f32af5-8d40-4480-b96e-\
bc57520be44d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consistency checks to add", "Subsection",
 CellChangeTimes->{{3.8093684259574947`*^9, 3.8093684288196764`*^9}, {
  3.8096304576193485`*^9, 
  3.809630458638577*^9}},ExpressionUUID->"82471af5-3f41-4371-92f5-\
117905ae1a32"],

Cell["\<\
- Does 0th order satisfy Stokes equation, BCs, continuity
- Does solution satisfy Lorentz Reciprocal theorem \
\>", "Text",
 CellChangeTimes->{{3.8093684322734547`*^9, 
  3.809368460298272*^9}},ExpressionUUID->"a8dddc60-cce0-47c2-a9ba-\
772eda8c2635"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{-2389, Automatic}, {Automatic, 120}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 473, 13, 73, "Input",ExpressionUUID->"8f807011-4ee0-4c8a-99a4-0c4c5dcb1e6d"],
Cell[CellGroupData[{
Cell[1078, 39, 1409, 21, 24, "Print",ExpressionUUID->"112f3404-b985-42f8-9774-32f5a41e0479"],
Cell[2490, 62, 1392, 21, 24, "Print",ExpressionUUID->"c91dc84f-52d8-4066-8cd9-ce1bee7acee1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3931, 89, 279, 7, 81, "Subsection",ExpressionUUID->"1932942e-5af2-41a9-b806-be40a27cc43a"],
Cell[CellGroupData[{
Cell[4235, 100, 5315, 113, 157, "Input",ExpressionUUID->"0c17bfc0-5c66-405b-bff1-9ee9d4aed5c4"],
Cell[9553, 215, 576, 9, 34, "Output",ExpressionUUID->"7dcf2a5d-91b9-426d-b490-c31eaae0fbeb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10178, 230, 183, 3, 54, "Subsection",ExpressionUUID->"4ed1d834-ea65-4d52-a3a8-ae7dd6fb7c8c"],
Cell[CellGroupData[{
Cell[10386, 237, 5249, 136, 283, "Input",ExpressionUUID->"0c604f9a-6a83-4431-a706-42b548bb95fb"],
Cell[15638, 375, 2384, 66, 53, "Output",ExpressionUUID->"1c1247a5-c88e-4a85-9792-0f7843d0762b"],
Cell[18025, 443, 868, 13, 34, "Output",ExpressionUUID->"8b45c8d7-8ca5-47ec-bbae-926d59cfff72"],
Cell[18896, 458, 1599, 37, 37, "Output",ExpressionUUID->"009aba60-14e2-4479-862c-a98b60b55153"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20544, 501, 228, 5, 54, "Subsection",ExpressionUUID->"a1c544bb-0935-4c50-8d26-fa759a91929a"],
Cell[CellGroupData[{
Cell[20797, 510, 4439, 121, 241, "Input",ExpressionUUID->"d8007271-49ae-457a-88dd-36c577ece5e7"],
Cell[25239, 633, 700, 11, 34, "Output",ExpressionUUID->"8b392ecf-7c10-4d8b-acc1-578298fdffe1"],
Cell[25942, 646, 702, 11, 34, "Output",ExpressionUUID->"3e28643a-1b67-4fd8-a391-2b63d45b8c7e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26681, 662, 1089, 27, 73, "Input",ExpressionUUID->"fd438e3d-8a14-43a5-9b97-f695f1237389"],
Cell[27773, 691, 1412, 20, 34, "Output",ExpressionUUID->"cd2dda8c-0b3a-4747-8f5f-8a35685051e0"],
Cell[29188, 713, 1414, 20, 34, "Output",ExpressionUUID->"9b4c32a6-1afb-44bf-becf-f669d8e1e72a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30651, 739, 238, 6, 54, "Subsection",ExpressionUUID->"1ffb09eb-fec8-460f-b8e4-a791e649bab9"],
Cell[CellGroupData[{
Cell[30914, 749, 3326, 78, 136, "Input",ExpressionUUID->"606be2d1-13d1-4005-b1b2-0a9cc225efa1"],
Cell[34243, 829, 3201, 92, 53, "Output",ExpressionUUID->"91990c79-5941-4322-b72d-3a51b0e60d3d"],
Cell[37447, 923, 1784, 42, 37, "Output",ExpressionUUID->"d64f4dd2-18e9-4286-81b4-3376a61aab71"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39280, 971, 189, 3, 54, "Subsection",ExpressionUUID->"09eda905-6954-478c-8894-a448f1406946"],
Cell[CellGroupData[{
Cell[39494, 978, 1327, 39, 94, "Input",ExpressionUUID->"ec4f4123-b675-4b80-98b8-6f17b590741e"],
Cell[40824, 1019, 1347, 24, 37, "Output",ExpressionUUID->"6c818846-16ab-4169-8f3e-2644edba7ccf"],
Cell[42174, 1045, 1236, 20, 37, "Output",ExpressionUUID->"197e9261-524c-4b5d-89d5-ec37b043ac89"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43459, 1071, 191, 3, 54, "Subsection",ExpressionUUID->"53810cd1-51bf-4cb7-b8de-680239455427"],
Cell[43653, 1076, 1367, 33, 73, "Input",ExpressionUUID->"e299319a-415b-4fa6-9da0-a89381ed5e74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45057, 1114, 177, 3, 54, "Subsection",ExpressionUUID->"0bc1d0e4-8152-4059-bc6e-7681433c02ea"],
Cell[CellGroupData[{
Cell[45259, 1121, 1141, 30, 30, "Input",ExpressionUUID->"1da00bd9-d6ee-497b-90d5-82ddbac9df02"],
Cell[46403, 1153, 969, 26, 37, "Output",ExpressionUUID->"02836099-a66e-4554-97d6-9ed1ba32a584"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47421, 1185, 173, 3, 54, "Subsection",ExpressionUUID->"c8aecce3-b181-493b-a1c5-0492208ec681"],
Cell[CellGroupData[{
Cell[47619, 1192, 3776, 89, 157, "Input",ExpressionUUID->"8af5c6dd-2a0d-4b88-a8ad-3c7644b9a6ed"],
Cell[51398, 1283, 1935, 41, 51, "Output",ExpressionUUID->"38110ed3-7449-4616-aba9-b14694c4ee74"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53382, 1330, 186, 3, 54, "Subsection",ExpressionUUID->"687bcad0-a44e-4785-8413-fe4658e60a09"],
Cell[CellGroupData[{
Cell[53593, 1337, 5824, 129, 262, "Input",ExpressionUUID->"2b7f7d2c-d4de-4ee2-a9a9-8469e5115ec3"],
Cell[59420, 1468, 2114, 31, 34, "Output",ExpressionUUID->"dc8f5da1-1817-4484-8b0e-f14d3f4ce07a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61583, 1505, 169, 3, 54, "Subsection",ExpressionUUID->"ab05e828-1d0b-4d73-8fd4-81a346f1f9d6"],
Cell[CellGroupData[{
Cell[61777, 1512, 4388, 80, 115, "Input",ExpressionUUID->"c2590065-374c-4c09-858d-bc1ae23b7fb7"],
Cell[66168, 1594, 2025, 37, 51, "Output",ExpressionUUID->"f59b65b9-f80c-4e9c-83c7-f2d7a39b32e3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68242, 1637, 215, 4, 54, "Subsection",ExpressionUUID->"a8f4ddbe-29a6-4fe4-ae17-b157141e002b"],
Cell[CellGroupData[{
Cell[68482, 1645, 4121, 106, 283, "Input",ExpressionUUID->"90126278-fa2d-4c79-a977-62d9f54e0980"],
Cell[72606, 1753, 1171, 33, 51, "Output",ExpressionUUID->"36cff5e6-aaf0-40e0-a1e5-9348a17b23d6"],
Cell[73780, 1788, 1154, 32, 51, "Output",ExpressionUUID->"398149ae-3364-4e3d-a6dd-4455e3c90bfa"],
Cell[74937, 1822, 1177, 33, 51, "Output",ExpressionUUID->"3cc23d9e-0f3d-41b0-a078-d3269181e1b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76151, 1860, 326, 7, 30, "Input",ExpressionUUID->"031bae21-cfb2-4cfb-96d2-0fe245151cbe"],
Cell[76480, 1869, 607, 16, 51, "Output",ExpressionUUID->"77716806-d457-458e-be2c-e541a0582216"]
}, Open  ]],
Cell[77102, 1888, 252, 6, 35, "Text",ExpressionUUID->"42f32af5-8d40-4480-b96e-bc57520be44d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77391, 1899, 228, 4, 54, "Subsection",ExpressionUUID->"82471af5-3f41-4371-92f5-117905ae1a32"],
Cell[77622, 1905, 261, 6, 58, "Text",ExpressionUUID->"a8dddc60-cce0-47c2-a9ba-772eda8c2635"]
}, Open  ]]
}
]
*)

