(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10738,        301]
NotebookOptionsPosition[      9773,        276]
NotebookOutlinePosition[     10119,        291]
CellTagsIndexPosition[     10076,        288]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "up", " ", "for", " ", "particle", " ", "settling", " ", 
    "along", " ", "shear", " ", "flow", " ", "direction"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"a", ",", "v", ",", "U", ",", "f", ",", "F", ",", "Wi"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], "*", "x"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xvec", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Grad", "[", "u", "]"}], " ", "defined", " ", "here", " ", "as",
       " ", "A_", 
      RowBox[{"{", "ij", "}"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Grad_j", " ", "u_i"}], " ", "=", " ", 
      RowBox[{"del", " ", 
       RowBox[{"u_i", " ", "/", " ", "del"}], " ", "x_j"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"Grad", "[", 
      RowBox[{"u", ",", "xvec"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"\[Gamma]", "/", "2"}], ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V0", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", "+", 
        RowBox[{"A", "\[Transpose]"}]}], ")"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", " ", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]",
    
   RowBox[{
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{"S", ",", "xvec"}], "]"}], " ", "//", " ", "MatrixForm"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", "-", 
        RowBox[{"A", "\[Transpose]"}]}], ")"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s", " ", "=", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", "*", 
       RowBox[{"Tr", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{"S", ",", "S"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Checks", " ", "-", " ", 
     RowBox[{"should", " ", "be", " ", "zero"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{"S", ",", "\[CapitalOmega]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Dot", "[", 
      RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], "]"}]}], "-", 
    RowBox[{"Tr", "[", 
     RowBox[{"Dot", "[", 
      RowBox[{"S", ",", "S"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      SuperscriptBox["\[Gamma]", "2"], "]"}], "-", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"Tr", "[", 
       RowBox[{"A", ".", 
        RowBox[{"A", "\[Transpose]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", "-", " ", "S", "-", "R"}], " ", "//", "MatrixForm"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", "\[Transpose]"}], "+", "A", " ", "-", " ", 
      RowBox[{"2", "S"}]}], " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Resistance", " ", "problem"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"p", ",", "U"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Squirmer", " ", "is", " ", "swimming", " ", "in", " ", "the"}], 
     " ", "+", 
     RowBox[{"z", " ", "direction"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"U", " ", "=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"6", "\[Pi]"}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"5", "\[CapitalGamma]"}]}], ")"}], "*", "\[Pi]", "*", 
       SubscriptBox["\[Eta]", "r"], "*", "Wi", "*", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"S", "/", "\[Gamma]"}], ",", "p"}], "]"}]}], 
      ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.788900664092428*^9, 3.7889007360893497`*^9}, {
  3.788901197278178*^9, 3.788901198253009*^9}, {3.788901229613577*^9, 
  3.7889012385976686`*^9}, {3.7889013615439777`*^9, 3.78890136700776*^9}, {
  3.7889014303662157`*^9, 3.788901430502472*^9}, {3.788901472545431*^9, 
  3.788901492608788*^9}, {3.806239420189444*^9, 3.806239470998217*^9}, {
  3.8062395693145847`*^9, 3.806239620322319*^9}, {3.806239681595963*^9, 
  3.806239683209607*^9}, {3.806783859746354*^9, 3.806783876232932*^9}, {
  3.806783908331727*^9, 3.806783922159012*^9}, {3.808050130082006*^9, 
  3.808050143965603*^9}, {3.808050262039324*^9, 3.808050262185192*^9}, {
  3.8092901925863376`*^9, 3.8092901941807027`*^9}, {3.809629598728469*^9, 
  3.809629605378968*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"f8e1bb92-62ff-4f53-b41d-663f9e1553b3"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7889007433164167`*^9, 3.78890119857029*^9, 3.7889013673409567`*^9, 
   3.788901430954657*^9, {3.788901473023222*^9, 3.788901492861568*^9}, 
   3.7889036353621473`*^9, {3.806783864499799*^9, 3.8067838798488207`*^9}, {
   3.8067839101731043`*^9, 3.8067839230505753`*^9}, {3.8080501369508753`*^9, 
   3.808050151157875*^9}, 3.8080502626592407`*^9, {3.8092901762486897`*^9, 
   3.809290196709259*^9}, 3.8096228828665514`*^9, {3.8096296225148315`*^9, 
   3.8096296257325525`*^9}},
 CellLabel->"Out[94]=",ExpressionUUID->"da1b8e20-cd95-4434-a0f7-4e9c04c4a186"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "12"]}], " ", "Wi", " ", 
    RowBox[{"(", 
     RowBox[{"3", "-", 
      RowBox[{"5", " ", "\[CapitalGamma]"}]}], ")"}], " ", 
    SubscriptBox["\[Eta]", "r"]}], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7889007433164167`*^9, 3.78890119857029*^9, 3.7889013673409567`*^9, 
   3.788901430954657*^9, {3.788901473023222*^9, 3.788901492861568*^9}, 
   3.7889036353621473`*^9, {3.806783864499799*^9, 3.8067838798488207`*^9}, {
   3.8067839101731043`*^9, 3.8067839230505753`*^9}, {3.8080501369508753`*^9, 
   3.808050151157875*^9}, 3.8080502626592407`*^9, {3.8092901762486897`*^9, 
   3.809290196709259*^9}, 3.8096228828665514`*^9, {3.8096296225148315`*^9, 
   3.809629625735553*^9}},
 CellLabel->
  "Out[100]=",ExpressionUUID->"89654325-3a8e-4bea-a8a5-4a09c26ea4d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", " ", "=", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"6", "\[Pi]"}], ")"}]}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "\[CapitalGamma]", "*", "\[Pi]", "*", 
     SubscriptBox["\[Eta]", "r"], "*", "Wi", "*", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"S", "/", "\[Gamma]"}], ",", "p"}], "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.809622873100374*^9, 3.8096228758149705`*^9}, 
   3.8096229721525335`*^9, {3.8096296204833827`*^9, 3.8096296227268887`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"a3da6e8d-a420-44e5-abc8-fd5d79487bbf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "6"], " ", "Wi", " ", "\[CapitalGamma]", " ", 
    SubscriptBox["\[Eta]", "r"]}], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.809622876640155*^9, 3.80962288299758*^9}, 
   3.8096229726506357`*^9, 3.809629625833575*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"becadb38-fe55-4da6-9a76-f23ff205b08e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", " ", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "7"}], "/", "3"}], "\[CapitalGamma]", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Beta]"}], ")"}], "*", "Wi", "*", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"S", "/", "\[Gamma]"}], ",", "p"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8096297596986685`*^9, 3.8096297819506617`*^9}, {
  3.8096300086835527`*^9, 3.809630011909289*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"2ea213e0-0ccc-401f-8898-f3f7351a9a73"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["7", "6"], " ", "Wi", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Beta]"}], ")"}], " ", "\[CapitalGamma]"}], ",", "0",
    ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.809629782820857*^9, 3.80963006474119*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"6c34ba94-10d3-43ca-9444-28a4d83a904d"]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{-1189, Automatic}, {Automatic, 100}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5671, 155, 547, "Input",ExpressionUUID->"f8e1bb92-62ff-4f53-b41d-663f9e1553b3"],
Cell[6254, 179, 607, 9, 32, "Output",ExpressionUUID->"da1b8e20-cd95-4434-a0f7-4e9c04c4a186"],
Cell[6864, 190, 875, 19, 49, "Output",ExpressionUUID->"89654325-3a8e-4bea-a8a5-4a09c26ea4d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7776, 214, 634, 17, 28, "Input",ExpressionUUID->"a3da6e8d-a420-44e5-abc8-fd5d79487bbf"],
Cell[8413, 233, 392, 9, 49, "Output",ExpressionUUID->"becadb38-fe55-4da6-9a76-f23ff205b08e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8842, 247, 540, 14, 28, "Input",ExpressionUUID->"2ea213e0-0ccc-401f-8898-f3f7351a9a73"],
Cell[9385, 263, 372, 10, 49, "Output",ExpressionUUID->"6c34ba94-10d3-43ca-9444-28a4d83a904d"]
}, Open  ]]
}
]
*)

