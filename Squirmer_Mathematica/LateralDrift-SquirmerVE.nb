(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8020,        222]
NotebookOptionsPosition[      7501,        205]
NotebookOutlinePosition[      7844,        220]
CellTagsIndexPosition[      7801,        217]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "up", " ", "for", " ", "particle", " ", "settling", " ", 
    "along", " ", "shear", " ", "flow", " ", "direction"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"a", ",", "v", ",", "U", ",", "f", ",", "F", ",", "Wi"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], "*", "x"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xvec", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Grad", "[", "u", "]"}], " ", "defined", " ", "here", " ", "as",
       " ", "A_", 
      RowBox[{"{", "ij", "}"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Grad_j", " ", "u_i"}], " ", "=", " ", 
      RowBox[{"del", " ", 
       RowBox[{"u_i", " ", "/", " ", "del"}], " ", "x_j"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"Grad", "[", 
      RowBox[{"u", ",", "xvec"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"\[Gamma]", "/", "2"}], ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V0", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", "+", 
        RowBox[{"A", "\[Transpose]"}]}], ")"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", " ", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]",
    
   RowBox[{
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{"S", ",", "xvec"}], "]"}], " ", "//", " ", "MatrixForm"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", "-", 
        RowBox[{"A", "\[Transpose]"}]}], ")"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s", " ", "=", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", "*", 
       RowBox[{"Tr", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{"S", ",", "S"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Checks", " ", "-", " ", 
     RowBox[{"should", " ", "be", " ", "zero"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{"S", ",", "\[CapitalOmega]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Dot", "[", 
      RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], "]"}]}], "-", 
    RowBox[{"Tr", "[", 
     RowBox[{"Dot", "[", 
      RowBox[{"S", ",", "S"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      SuperscriptBox["\[Gamma]", "2"], "]"}], "-", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"Tr", "[", 
       RowBox[{"A", ".", 
        RowBox[{"A", "\[Transpose]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", "-", " ", "S", "-", "R"}], " ", "//", "MatrixForm"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", "\[Transpose]"}], "+", "A", " ", "-", " ", 
      RowBox[{"2", "S"}]}], " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Resistance", " ", "problem"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"p", ",", "U"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Squirmer", " ", "is", " ", "swimming", " ", "in", " ", "the"}],
       " ", "+", 
      RowBox[{"z", " ", "direction"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"U", " ", "=", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"6", "\[Pi]"}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{"3", "-", 
        RowBox[{"5", "\[CapitalGamma]"}]}], ")"}], "*", "\[Pi]", "*", 
      SubscriptBox["\[Eta]", "r"], "*", "Wi", "*", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"S", "/", "\[Gamma]"}], ",", "p"}], "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.788900664092428*^9, 3.7889007360893497`*^9}, {
  3.788901197278178*^9, 3.788901198253009*^9}, {3.788901229613577*^9, 
  3.7889012385976686`*^9}, {3.7889013615439777`*^9, 3.78890136700776*^9}, {
  3.7889014303662157`*^9, 3.788901430502472*^9}, {3.788901472545431*^9, 
  3.788901492608788*^9}, {3.806239420189444*^9, 3.806239470998217*^9}, {
  3.8062395693145847`*^9, 3.806239620322319*^9}, {3.806239681595963*^9, 
  3.806239683209607*^9}, {3.806783859746354*^9, 3.806783876232932*^9}, {
  3.806783908331727*^9, 3.806783922159012*^9}, {3.808050130082006*^9, 
  3.808050143965603*^9}, {3.808050262039324*^9, 3.808050262185192*^9}, {
  3.8092901925863376`*^9, 3.8092901941807027`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"f8e1bb92-62ff-4f53-b41d-663f9e1553b3"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7889007433164167`*^9, 3.78890119857029*^9, 3.7889013673409567`*^9, 
   3.788901430954657*^9, {3.788901473023222*^9, 3.788901492861568*^9}, 
   3.7889036353621473`*^9, {3.806783864499799*^9, 3.8067838798488207`*^9}, {
   3.8067839101731043`*^9, 3.8067839230505753`*^9}, {3.8080501369508753`*^9, 
   3.808050151157875*^9}, 3.8080502626592407`*^9, {3.8092901762486897`*^9, 
   3.809290196709259*^9}},
 CellLabel->"Out[57]=",ExpressionUUID->"81a0515d-0a0e-4ab3-80e7-85d2dce79f28"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "12"]}], " ", "Wi", " ", 
    RowBox[{"(", 
     RowBox[{"3", "-", 
      RowBox[{"5", " ", "\[CapitalGamma]"}]}], ")"}], " ", 
    SubscriptBox["\[Eta]", "r"]}], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7889007433164167`*^9, 3.78890119857029*^9, 3.7889013673409567`*^9, 
   3.788901430954657*^9, {3.788901473023222*^9, 3.788901492861568*^9}, 
   3.7889036353621473`*^9, {3.806783864499799*^9, 3.8067838798488207`*^9}, {
   3.8067839101731043`*^9, 3.8067839230505753`*^9}, {3.8080501369508753`*^9, 
   3.808050151157875*^9}, 3.8080502626592407`*^9, {3.8092901762486897`*^9, 
   3.80929019671326*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"e15c3821-e01a-452e-8567-a20ebe419d1a"]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{168, Automatic}, {91, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5576, 151, 547, "Input",ExpressionUUID->"f8e1bb92-62ff-4f53-b41d-663f9e1553b3"],
Cell[6159, 175, 529, 8, 32, "Output",ExpressionUUID->"81a0515d-0a0e-4ab3-80e7-85d2dce79f28"],
Cell[6691, 185, 794, 17, 49, "Output",ExpressionUUID->"e15c3821-e01a-452e-8567-a20ebe419d1a"]
}, Open  ]]
}
]
*)

